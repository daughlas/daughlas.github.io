<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <meta name="msapplication-config" content="/images/browserconfig.xml">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="记录生活、工作、学习的点点滴滴">
<meta property="og:type" content="website">
<meta property="og:title" content="嘉文小栈">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="嘉文小栈">
<meta property="og:description" content="记录生活、工作、学习的点点滴滴">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="吕嘉文">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>嘉文小栈</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">嘉文小栈</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">每天进步一点点</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/02/tools/Learn_git/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/icon.jpg">
      <meta itemprop="name" content="吕嘉文">
      <meta itemprop="description" content="记录生活、工作、学习的点点滴滴">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嘉文小栈">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/02/tools/Learn_git/" class="post-title-link" itemprop="url">git 学习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-06-02 18:57:35 / 修改时间：18:57:49" itemprop="dateCreated datePublished" datetime="2020-06-02T18:57:35+08:00">2020-06-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">工具</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ol>
<li>输入git 或者 git help 会显示出常用的命令和解释</li>
<li>git help -a 显示所有命令</li>
<li>git help -g 显示手册，继续输入标题，进入详细说明，例如git help add，F 键乡下翻页，B 键向上翻页，q 推出介绍</li>
<li>配置 git<ol>
<li>system设置：所有使用这台电脑的人</li>
<li>global设置： 全局，用户设置<ol>
<li><code>git config --global user.name &quot;吕嘉文&quot;</code>，设置名字</li>
<li><code>git config --list</code> ,查看配置</li>
<li><code>git config --unset --global user.name</code>，删除掉 user.name 这个配置</li>
<li>其他可以配置的<code>git config --global user.email/color.ui(true)/ &quot;设置项&quot;</code></li>
</ol>
</li>
<li>project设置： 针对项目进行设置</li>
</ol>
</li>
<li>初始化一个项目<ol>
<li>命令init ，是initialize 的简写</li>
<li>在项目的目录下面执行<code>git init</code></li>
<li>不想 git 跟踪项目的话，删除 .git 这个文件就行了 </li>
</ol>
</li>
<li>提交<ol>
<li>修改了文件之后，添加一条修改描述的信息</li>
<li>在工作目录下输入 <code>git status</code>，会显示当前所在的分支，</li>
<li>initial commit 表示一个初始的提交</li>
<li>nothng to commit 目前没有变化需要提交</li>
<li>新建文件之后，输入 <code>git status</code>，这些文件会显示为untracked files，输入<code>git add .</code> 跟踪所有文件，或者 <code>git add 文件名</code>，跟踪指定的文件。</li>
<li>跟踪的文件有变化的话，输入git status 会提示changes to be commit 将要提交的修改</li>
<li><code>git commit 描述信息</code> -m ‘确认提交’`</li>
<li>git log 查看以往的提交</li>
</ol>
</li>
<li>修改一个文件之后<ol>
<li><code>git status</code> 的结果是 changes not staged for commit 没有存到暂存区的修改</li>
<li><code>git diff 文件名称</code> 会显示文件修改之后的对比，如果不加文件名称，会对比所有修改过的文件，默认对比的是暂存区和工作目录的对比，想要比较仓库中的文件可以输入<code>git diff --staged</code></li>
<li><code>git add 文件名称</code>， 就把文件添加到暂存区中了</li>
</ol>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/02/algorithms/imooc-JavaScript%E7%89%88%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/icon.jpg">
      <meta itemprop="name" content="吕嘉文">
      <meta itemprop="description" content="记录生活、工作、学习的点点滴滴">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嘉文小栈">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/02/algorithms/imooc-JavaScript%E7%89%88%20%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">imooc-JavaScript版 数据结构与算法笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-06-02 18:53:00 / 修改时间：18:53:42" itemprop="dateCreated datePublished" datetime="2020-06-02T18:53:00+08:00">2020-06-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="导学"><a href="#导学" class="headerlink" title="导学"></a>导学</h2><h3 id="学习方法"><a href="#学习方法" class="headerlink" title="学习方法"></a>学习方法</h3><ol>
<li>通过解题，夯实基础算法</li>
<li>理解算法的本质是学会挖掘规律</li>
<li>举一反三学会变通和延伸</li>
</ol>
<h3 id="课程内容"><a href="#课程内容" class="headerlink" title="课程内容"></a>课程内容</h3><ol>
<li>基础算法<ol>
<li>字符串<ol>
<li>反转字符串中的单词</li>
<li>计算二进制子串</li>
</ol>
</li>
<li>数组<ol>
<li>电话号码组合</li>
<li>卡牌分组</li>
<li>种花问题</li>
<li>格雷编码</li>
</ol>
</li>
<li>正则表达式<ol>
<li>重复的子字符串</li>
<li>正则表达式匹配</li>
</ol>
</li>
<li>排序<ol>
<li>冒泡排序</li>
<li>选择排序</li>
<li>按奇偶排序数组</li>
<li>数组中的第K个最大元素</li>
<li>最大间距</li>
<li>缺失的第一个正数</li>
</ol>
</li>
<li>递归<ol>
<li>复原 IP 地址</li>
<li>与所有单词相关联的字符串</li>
</ol>
</li>
</ol>
</li>
<li>数据结构<ol>
<li>堆<ol>
<li>根据字符出现频率排序</li>
<li>超级丑数</li>
</ol>
</li>
<li>栈<ol>
<li>棒球比赛</li>
<li>最大矩形</li>
</ol>
</li>
<li>队列<ol>
<li>设计循环队列</li>
<li>任务调度器</li>
</ol>
</li>
<li>链表<ol>
<li>排序链表</li>
<li>环形链表</li>
</ol>
</li>
<li>矩阵<ol>
<li>螺旋矩阵</li>
<li>旋转图像</li>
</ol>
</li>
<li>二叉树<ol>
<li>对称二叉树</li>
<li>验证二叉树</li>
</ol>
</li>
</ol>
</li>
<li>进阶算法<ol>
<li>贪心算法<ol>
<li>买卖股票的最佳世纪</li>
<li>柠檬水找零</li>
</ol>
</li>
<li>动态规划<ol>
<li>不同路径II</li>
<li>K 站中转内最便宜的航班</li>
</ol>
</li>
</ol>
</li>
</ol>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ol>
<li>避免浮躁、按部就班</li>
<li>不投机取巧、循序渐</li>
</ol>
<h3 id="学习姿势"><a href="#学习姿势" class="headerlink" title="学习姿势"></a>学习姿势</h3><ul>
<li>目的：<ul>
<li>面试：见多识广、反应迅速、过程大于结果</li>
<li>进阶：打开思路、快速迭代、精益求精</li>
</ul>
</li>
</ul>
<h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>基础知识：ES6 + Jest + NPM + Git</p>
<p>知识：<a href="https://github.com/cucygh/fe-material" target="_blank" rel="noopener">https://github.com/cucygh/fe-material</a></p>
<p>源码核心配置文件 <code>.babelrc</code>， <code>.eslintrc.js</code>，<code>packgage.json</code></p>
<p>使用源码步骤：<code>git clone 源码地址 leetcode</code></p>
<p>分支</p>
<ul>
<li>master 分支：环境搭建原始内容，<code>git checkout master</code></li>
<li>dev 分支：所有源码，<code>git checkout dev</code></li>
<li>代码改动，而且没有提交，这个时候 checkout 会失败</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/02/node/imooc-Node.js+KOA2%20%E4%BB%8E0%E5%88%B01%E6%89%93%E9%80%A0%E8%B6%85%E5%A5%BD%E7%94%A8Web%E6%A1%86%E6%9E%B6%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/icon.jpg">
      <meta itemprop="name" content="吕嘉文">
      <meta itemprop="description" content="记录生活、工作、学习的点点滴滴">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嘉文小栈">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/02/node/imooc-Node.js+KOA2%20%E4%BB%8E0%E5%88%B01%E6%89%93%E9%80%A0%E8%B6%85%E5%A5%BD%E7%94%A8Web%E6%A1%86%E6%9E%B6%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">imooc-Node.js+KOA2 从0到1打造超好用Web框架笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-06-02 18:46:51 / 修改时间：18:47:56" itemprop="dateCreated datePublished" datetime="2020-06-02T18:46:51+08:00">2020-06-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Node/" itemprop="url" rel="index"><span itemprop="name">Node</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="第-1-章"><a href="#第-1-章" class="headerlink" title="第 1 章"></a>第 1 章</h1><h2 id="1-1-导学"><a href="#1-1-导学" class="headerlink" title="1-1 导学"></a>1-1 导学</h2><h3 id="Node-js-能力"><a href="#Node-js-能力" class="headerlink" title="Node.js 能力"></a>Node.js 能力</h3><ul>
<li>脱离浏览器运行 JS</li>
<li>Node.js Stream （前端工程化基础）</li>
<li>服务端 API</li>
<li>作为中间层</li>
</ul>
<h3 id="CTO-往往是服务端工程师"><a href="#CTO-往往是服务端工程师" class="headerlink" title="CTO 往往是服务端工程师"></a>CTO 往往是服务端工程师</h3><ul>
<li>需要设计整个公司技术架构</li>
<li>需要从全局考虑问题</li>
<li>需要掌控公司最重要的资产：数据（谁掌握数据，谁才有话语权）</li>
</ul>
<h2 id="1-2-异步、javascript-特性与-Node-js"><a href="#1-2-异步、javascript-特性与-Node-js" class="headerlink" title="1-2 异步、javascript 特性与 Node.js"></a>1-2 异步、javascript 特性与 Node.js</h2><blockquote>
<p>编程，实践性非常强，注意，不要把关注点仅仅放在业务上，业务只是为了承载知识。</p>
</blockquote>
<h1 id="第-2-章-深入理解-KOA"><a href="#第-2-章-深入理解-KOA" class="headerlink" title="第 2 章 深入理解 KOA"></a>第 2 章 深入理解 KOA</h1><h2 id="2-3-KOA-的精简特性与二次开发必要性分析"><a href="#2-3-KOA-的精简特性与二次开发必要性分析" class="headerlink" title="2-3 KOA 的精简特性与二次开发必要性分析"></a>2-3 KOA 的精简特性与二次开发必要性分析</h2><ul>
<li><p>后端不同于前端：读写数据库、API</p>
</li>
<li><p>框架：</p>
<ul>
<li>写出好的代码</li>
<li>提高开发效率</li>
</ul>
</li>
<li><p>数据库</p>
<ul>
<li>悲观锁</li>
<li>乐观锁</li>
<li>事物</li>
<li>脏读</li>
<li>幻读</li>
</ul>
</li>
<li><p>Node.js API 低级，基础</p>
</li>
<li><p>KOA 特点</p>
<ul>
<li>洋葱圈模型</li>
<li>精简 =&gt; 定制化能力强，适合二次开发</li>
</ul>
</li>
</ul>
<h2 id="2-4-模块加载、ES、TS、Babel-浅析"><a href="#2-4-模块加载、ES、TS、Babel-浅析" class="headerlink" title="2-4 模块加载、ES、TS、Babel 浅析"></a>2-4 模块加载、ES、TS、Babel 浅析</h2><h3 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h3><h4 id="commonJS"><a href="#commonJS" class="headerlink" title="commonJS"></a>commonJS</h4><pre><code>const Koa = require(&#39;koa&#39;)</code></pre><h4 id="ES6"><a href="#ES6" class="headerlink" title="ES6"></a>ES6</h4><pre><code>import Koa from &#39;koa&#39;</code></pre><h3 id="Node-里边不能用的-ES-新特性"><a href="#Node-里边不能用的-ES-新特性" class="headerlink" title="Node 里边不能用的 ES 新特性"></a>Node 里边不能用的 ES 新特性</h3><ul>
<li>import 不能使用</li>
<li>decorator不能使用</li>
<li>class 的时候必须要写 this.x</li>
</ul>
<h2 id="2-5-KOA-中间件"><a href="#2-5-KOA-中间件" class="headerlink" title="2-5 KOA 中间件"></a>2-5 KOA 中间件</h2><p>中间件，就是函数</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span></code></pre>
<h3 id="2-6-洋葱圈模型"><a href="#2-6-洋葱圈模型" class="headerlink" title="2-6 洋葱圈模型"></a>2-6 洋葱圈模型</h3><pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">// 应用程序对象，挂载很多中间件</span>
<span class="token comment" spellcheck="true">// 注册</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">// 打印顺序 1，3， 4， 2</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span></code></pre>
<p>注意：</p>
<ul>
<li><strong>use 的回调函数前边一定要写 async</strong></li>
<li><strong>next 前边一定要写await</strong></li>
</ul>
<h3 id="2-7-强制-Promise"><a href="#2-7-强制-Promise" class="headerlink" title="2-7 强制 Promise"></a>2-7 强制 Promise</h3><pre><code>const koa = require(&#39;koa&#39;)
const app = new koa()

app.use((ctx, next) =&gt; {
  console.log(1)
  const a = next()
  console.log(a) // Promise { &#39;abc&#39; }
  console.log(2)
})
app.use((ctx, next) =&gt; {
  console.log(3)
  console.log(4)
  return &#39;abc&#39;
})

app.listen(3000)</code></pre><h3 id="深入理解-async-和-await"><a href="#深入理解-async-和-await" class="headerlink" title="深入理解 async 和 await"></a>深入理解 async 和 await</h3><ul>
<li>await 可以理解为求值关键字，将 Promise 转化为成功时的返回值，await 可以对任何表达式求值</li>
<li>await 会阻塞线程</li>
<li>async 的意义就是加上 async 的函数，任何返回值都会被包装成 Promise</li>
</ul>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// abc</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token string">'abc'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span></code></pre>
<h3 id="2-9-为什么一定要保证洋葱圈模型"><a href="#2-9-为什么一定要保证洋葱圈模型" class="headerlink" title="2-9 为什么一定要保证洋葱圈模型"></a>2-9 为什么一定要保证洋葱圈模型</h3><p>如果不在 next 前加 await，不在中间件函数里边加 async，就不能保证洋葱圈模型了</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> axios <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'axios'</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'https://www.baidu.com'</span><span class="token punctuation">)</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">// 1, 3, 4, 2, 'abc'</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span></code></pre>
<p>axios 请求的时候阻塞了线程，遇到阻塞线程的操作的时候，js 就回去执行下面的代码</p>
<p>中间件函数被next 分为两部分，next 函数之前的部分，所有之后的中间件都还没有执行，next 之后的部分，所有中间件都已经执行完毕了。</p>
<h2 id="第3章"><a href="#第3章" class="headerlink" title="第3章"></a>第3章</h2><h3 id="3-1-路由系统"><a href="#3-1-路由系统" class="headerlink" title="3-1 路由系统"></a>3-1 路由系统</h3><p>啥啥没有的情况</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> <span class="token punctuation">{</span>path<span class="token punctuation">,</span>method<span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request
  <span class="token keyword">if</span> <span class="token punctuation">(</span>path <span class="token operator">===</span> <span class="token string">'/classic/latest'</span> <span class="token operator">&amp;&amp;</span> method <span class="token operator">===</span> <span class="token string">'GET'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
      key<span class="token punctuation">:</span> <span class="token string">'classic'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span></code></pre>
<p>简单使用 koa-router</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa-router'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'/classic/latest'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
    key<span class="token punctuation">:</span> <span class="token string">'classic123123'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span></code></pre>
<h3 id="3-2-服务端编程必备思维：主题与模型划分"><a href="#3-2-服务端编程必备思维：主题与模型划分" class="headerlink" title="3-2 服务端编程必备思维：主题与模型划分"></a>3-2 服务端编程必备思维：主题与模型划分</h3><ul>
<li>好的代码利于阅读</li>
<li>好的代码利于维护</li>
<li>好的代码利于提高编程效率</li>
</ul>
<p>主题：抽象的概念，抽象的概念有助于思考，概念类似于 Model</p>
<p>主题的划分：</p>
<ul>
<li>期刊</li>
<li>书籍</li>
<li>点赞</li>
<li>用户</li>
</ul>
<h3 id="3-3-多-router-拆分路由"><a href="#3-3-多-router-拆分路由" class="headerlink" title="3-3 多 router 拆分路由"></a>3-3 多 router 拆分路由</h3><h4 id="API-携带版本号："><a href="#API-携带版本号：" class="headerlink" title="API 携带版本号："></a>API 携带版本号：</h4><ol>
<li>放在路径之中</li>
<li>放在查询参数</li>
<li>放在 http header 之中</li>
</ol>
<h4 id="开闭原则"><a href="#开闭原则" class="headerlink" title="开闭原则"></a>开闭原则</h4><ul>
<li>对修改关闭，对拓展开放</li>
<li>对每个版本的 API 都写一个路由函数</li>
</ul>
<h1 id="第4章"><a href="#第4章" class="headerlink" title="第4章"></a>第4章</h1><h2 id="4-1-参数获取"><a href="#4-1-参数获取" class="headerlink" title="4-1 参数获取"></a>4-1 参数获取</h2><ul>
<li>path 路由参数：<code>ctx.params</code></li>
<li>query 参数: <code>ctx.request.query</code></li>
<li>headers 参数: <code>ctx.request.headers</code></li>
<li>body 参数: <code>ctx.request.body</code>（需要使用body-parser： <code>app.use(parser())</code>）</li>
</ul>
<h2 id="4-2-异常理论与异常链"><a href="#4-2-异常理论与异常链" class="headerlink" title="4-2 异常理论与异常链"></a>4-2 异常理论与异常链</h2><h3 id="异常链"><a href="#异常链" class="headerlink" title="异常链"></a>异常链</h3><pre><code>function func1() {
  try {
    func2()
  } catch (error) {
    throw error
  }
}

function func2() {
  try {
    func3()
  } catch (error) {
    throw error
  }
}

function func3() {
  try {
    console.log(0/a)
  } catch (error) {
    throw error
  }
}

func1()</code></pre><h2 id="4-3-异步异常处理"><a href="#4-3-异步异常处理" class="headerlink" title="4-3 异步异常处理"></a>4-3 异步异常处理</h2><p>try-catch 只对同步的方法有效，不能捕获异步的异常</p>
<blockquote>
<p>返回 Promise 的函数就可以使用 async 和 await 来改写</p>
</blockquote>
<p>await 对异步操作求值</p>
<p>await 把异步的异常给释放了出来</p>
<p>很多后如果不加 await ，异常就会变成一个 unhandled promise rejections</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> error
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">func3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// throw error</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">func3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> r <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>r <span class="token operator">&lt;</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<h2 id="4-4-全局异常处理中间件编写"><a href="#4-4-全局异常处理中间件编写" class="headerlink" title="4-4 全局异常处理中间件编写"></a>4-4 全局异常处理中间件编写</h2><p>面向切面编程 AOP，不考虑细节</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> catchError <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">'服务器有点问题，你等一下'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> catchError</code></pre>
<h3 id="4-5-已知错误与未知错误"><a href="#4-5-已知错误与未知错误" class="headerlink" title="4-5 已知错误与未知错误"></a>4-5 已知错误与未知错误</h3><p>应该返回给前端：</p>
<ul>
<li>HTTP status code： 2xx， 4xx， 5xx</li>
<li>message 具体的，文字化的信息</li>
<li>error_code <ul>
<li>开发者自己定义</li>
<li>可以是五位 10001， 20003</li>
</ul>
</li>
<li>request_url</li>
</ul>
<p>错误的分类</p>
<ul>
<li>已知型错误，参数类型不符合这些</li>
<li>未知型错误，程序潜在的错误，开发者无意识的</li>
</ul>
<h2 id="4-6-定义异常返回格式"><a href="#4-6-定义异常返回格式" class="headerlink" title="4-6 定义异常返回格式"></a>4-6 定义异常返回格式</h2><p>抛出异常</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> error <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'我是错误信息'</span><span class="token punctuation">)</span>
error<span class="token punctuation">.</span>errorCode <span class="token operator">=</span> <span class="token number">10001</span>
error<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">400</span> <span class="token comment" spellcheck="true">// 参数错误</span>
error<span class="token punctuation">.</span>requestUrl <span class="token operator">=</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ctx<span class="token punctuation">.</span>method<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ctx<span class="token punctuation">.</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span>
<span class="token keyword">throw</span> error</code></pre>
<p>处理错误中间件：</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> catchError <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>errorCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// 已知异常</span>
      ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        msg<span class="token punctuation">:</span> error<span class="token punctuation">.</span>message<span class="token punctuation">,</span>
        errorCode<span class="token punctuation">:</span> error<span class="token punctuation">.</span>errorCode<span class="token punctuation">,</span>
        request<span class="token punctuation">:</span> error<span class="token punctuation">.</span>requestUrl<span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
      ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> error<span class="token punctuation">.</span>status
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> catchError</code></pre>
<h3 id="4-7-定义-HttpExeption-异常基类"><a href="#4-7-定义-HttpExeption-异常基类" class="headerlink" title="4-7 定义 HttpExeption 异常基类"></a>4-7 定义 HttpExeption 异常基类</h3><pre><code>class HttpException extends Error {
  constructor(msg=&#39;服务器异常&#39;, errorCode=10000, code=400) {
    super()
    this.errorCode = errorCode
    this.code = code // httpStatus
    this.msg = msg
  }
}

module.exports = HttpException</code></pre><h3 id="4-8-特定异常类与-global-全局变量"><a href="#4-8-特定异常类与-global-全局变量" class="headerlink" title="4-8 特定异常类与 global 全局变量"></a>4-8 特定异常类与 global 全局变量</h3><h1 id="第-5-章"><a href="#第-5-章" class="headerlink" title="第 5 章"></a>第 5 章</h1><h2 id="5-2"><a href="#5-2" class="headerlink" title="5-2"></a>5-2</h2><p>lodash 一个库</p>
<p>深拷贝</p>
<p>validator.js 一个库</p>
<h2 id="5-4"><a href="#5-4" class="headerlink" title="5-4"></a>5-4</h2><p>通用型用户系统</p>
<ul>
<li>账号、密码、附属信息</li>
<li>注册、登录</li>
</ul>
<p>数据库：</p>
<ul>
<li>非关系型：<ul>
<li>（文档型）：MongoDB（持久化数据）</li>
<li>key-value 型：Redis（缓存、提高查询数据的速度）</li>
</ul>
</li>
<li>关系型：<ul>
<li>My SQL</li>
</ul>
</li>
</ul>
<h3 id="5-6-Sequelize-初始化配置与注意事项"><a href="#5-6-Sequelize-初始化配置与注意事项" class="headerlink" title="5-6 Sequelize 初始化配置与注意事项"></a>5-6 Sequelize 初始化配置与注意事项</h3><p>Wequelize 链接数据库，配置数据库参数</p>
<p>主键，不能重复，不能为空，可以自动增长</p>
<p>数字的主键查询性能好</p>
<p>1，2，3 这种自增长的字符串，遇到 1000 个并发很有可能就会计算重复</p>
<p>自增长 会 暴露用户编号，但是其实没什么，要做到，即使知道用户编号，也做不了什么</p>
<p>接口保护 鉴定权限 访问接口 Token</p>
<p>上线之后，数据迁移或者手动维护来更改表，推荐手动维护</p>
<p>数据迁移，SQL 更新，表设计的不好的时候可以用一下</p>
<p>设计接口的思维路径：（注册为例）</p>
<ul>
<li>先考虑接受的参数<ul>
<li>email</li>
<li>password1</li>
<li>password2</li>
<li>nickname</li>
</ul>
</li>
<li>在引入 Validator</li>
</ul>
<p>中间件是一个静态的方式，每一个请求进来都会实例化 RegisterValidator，10个请求10个实例，下面这样写</p>
<pre><code>router.post(&#39;register&#39;, new RegisterValidator(), async (ctx, next) =&gt; {
    // ...
})</code></pre><p>只在 KOA 项目启动的时候，new 一次 RegisterValidator，问题时 挂载在 RegisterValidator 实例上的属性就会被许多请求更改</p>
<p>函数通常不会保存变量的状态，类实例化的对象可以保存变量的状态</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/02/ai/imooc%20%E5%89%8D%E7%AB%AF%E5%85%A5%E9%97%A8%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/icon.jpg">
      <meta itemprop="name" content="吕嘉文">
      <meta itemprop="description" content="记录生活、工作、学习的点点滴滴">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嘉文小栈">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/02/ai/imooc%20%E5%89%8D%E7%AB%AF%E5%85%A5%E9%97%A8%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" class="post-title-link" itemprop="url">imooc 前端入门人工智能</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-06-02 18:44:46 / 修改时间：18:46:03" itemprop="dateCreated datePublished" datetime="2020-06-02T18:44:46+08:00">2020-06-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" itemprop="url" rel="index"><span itemprop="name">人工智能</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="第2章-机器学习与神经网络简介"><a href="#第2章-机器学习与神经网络简介" class="headerlink" title="第2章 机器学习与神经网络简介"></a>第2章 机器学习与神经网络简介</h1><h2 id="2-1-机器学习简介"><a href="#2-1-机器学习简介" class="headerlink" title="2-1 机器学习简介"></a>2-1 机器学习简介</h2><h3 id="2-1-1-机器学习是什么？"><a href="#2-1-1-机器学习是什么？" class="headerlink" title="2-1-1 机器学习是什么？"></a>2-1-1 机器学习是什么？</h3><ul>
<li>机器学习是指对能通过 <strong><em>经验</em></strong> 自动改进的计算机算法的研究。</li>
<li>机器学习使用 <strong><em>数据</em></strong> 或以往的 <strong><em>经验</em></strong> ，以此优化计算机程序的性能标准。</li>
</ul>
<h3 id="2-1-2-机器学习例子（以往的经验-数据）"><a href="#2-1-2-机器学习例子（以往的经验-数据）" class="headerlink" title="2-1-2 机器学习例子（以往的经验 / 数据）"></a>2-1-2 机器学习例子（以往的经验 / 数据）</h3><ul>
<li>用很多男子的脚长的平均值，估计男子脚长</li>
<li>线性回归<ul>
<li>身高体重预测</li>
<li>房价预测（面积、价格）</li>
</ul>
</li>
<li>逻辑回归</li>
<li>语音助手</li>
</ul>
<h3 id="2-1-3-为何要用机器学习？"><a href="#2-1-3-为何要用机器学习？" class="headerlink" title="2-1-3 为何要用机器学习？"></a>2-1-3 为何要用机器学习？</h3><ul>
<li>有些棘手问题只能用机器学习来解决（程序员写代码来解决，可能吗？）</li>
<li>获取数据比编写规则更加容易</li>
<li>GPU 等计算能力显著提升（使用机器学习成本将下来了）</li>
</ul>
<h3 id="2-1-3-机器学习如何运作？"><a href="#2-1-3-机器学习如何运作？" class="headerlink" title="2-1-3 机器学习如何运作？"></a>2-1-3 机器学习如何运作？</h3><ul>
<li>神经网络（重点）</li>
<li>决策树、支持向量机、贝叶斯分类器、强化学习….</li>
</ul>
<h2 id="2-2-神经网络简介"><a href="#2-2-神经网络简介" class="headerlink" title="2-2 神经网络简介"></a>2-2 神经网络简介</h2><ul>
<li><p>运算模型（输入到输出的映射）</p>
</li>
<li><p>人工神经网络是一种运算模型（就是输入输出的映射），由大量的节点（或称神经元）之间相互连接构成</p>
</li>
<li><p>下图，用输入相亲对象的信息，得出是否满意。</p>
</li>
</ul>
<p>![image-20200208093440239](/Users/lvjiawen/Library/Application Support/typora-user-images/image-20200208093440239.png)</p>
<ul>
<li>其他复杂因素：<ul>
<li>偏置</li>
<li>激活函数，到一定程度就可以了，不要再线性增长了</li>
<li>权重</li>
</ul>
</li>
</ul>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul>
<li>每个神经元里存储着若干权重（weight）、偏置（bias）、和一个激活函数（activation）</li>
<li>输入乘上权重加上偏置，经过激活函数得到输出</li>
<li>激活函数用于添加一些非线性的变化</li>
<li>神经网络通常包含一个输入层、若干隐藏层，一个输出层，输入层通常不用于计算神经网络的层数</li>
</ul>
<h3 id="2-3-神经网络的训练"><a href="#2-3-神经网络的训练" class="headerlink" title="2-3 神经网络的训练"></a>2-3 神经网络的训练</h3><h3 id="什么是神经网络的训练？"><a href="#什么是神经网络的训练？" class="headerlink" title="什么是神经网络的训练？"></a>什么是神经网络的训练？</h3><ul>
<li><p>给大量输入和输出，算出神经网络里所有神经元的权重、偏置，然后给定新的输入，可以算出新的输出</p>
</li>
<li><p>在机器学习力，输入输出被称为 <strong><em>特征</em></strong> 和 <strong><em>标签</em></strong> ，大连输入输出被称为 <strong><em>训练集</em></strong></p>
</li>
<li><p>给1000 个相亲对象的数据（特征），和对应的满意程度（标签），训练完后，给一份新的相亲对象的数据，就可以判断满意程度了。</p>
</li>
</ul>
<h3 id="如何训练神经网络？"><a href="#如何训练神经网络？" class="headerlink" title="如何训练神经网络？"></a>如何训练神经网络？</h3><ul>
<li>初始化：随机生成一些权重和偏置</li>
<li>计算损失：给定特征，计算出标签，得到它与真实标签差的多远</li>
<li>优化：微调权重和偏置，使损失变小</li>
</ul>
<h3 id="前向传播与反向传播"><a href="#前向传播与反向传播" class="headerlink" title="前向传播与反向传播"></a>前向传播与反向传播</h3><ul>
<li>前向传播：将训练的数据的特征送入网络，得到标签（第一 =》 第二层 =》。。。 =》 最后一层）</li>
<li>反向传播：计算损失并优化（先调整最后一层，再调整倒数第二层）<ul>
<li>注：原理见微积分的链式法则</li>
</ul>
</li>
</ul>
<h3 id="如何计算损失？"><a href="#如何计算损失？" class="headerlink" title="如何计算损失？"></a>如何计算损失？</h3><ul>
<li>使用 <strong><em>损失函数</em></strong>（科学家研究出来的）</li>
<li>例如：均方误差、对数损失、交叉熵</li>
<li>了解原理即可，工作中可以直接从第三方库中调用</li>
</ul>
<h3 id="如何优化？"><a href="#如何优化？" class="headerlink" title="如何优化？"></a>如何优化？</h3><ul>
<li>使用 <strong><em>优化器</em></strong> （科学家研究出来的）</li>
<li>例如：随机梯度下降（SGD）、Adam</li>
<li>了解原理即可，工作中可以直接从第三方库中调用</li>
</ul>
<h1 id="第3章-Tensorflow-js-简介"><a href="#第3章-Tensorflow-js-简介" class="headerlink" title="第3章 Tensorflow.js 简介"></a>第3章 Tensorflow.js 简介</h1><h2 id="3-1-Tensorflow-js-是什么"><a href="#3-1-Tensorflow-js-是什么" class="headerlink" title="3-1 Tensorflow.js 是什么"></a>3-1 Tensorflow.js 是什么</h2><h3 id="Tensorflow-js-是什么"><a href="#Tensorflow-js-是什么" class="headerlink" title="Tensorflow.js 是什么"></a>Tensorflow.js 是什么</h3><ul>
<li>一个用 javascript 实现的机器学习库</li>
<li>可以直接在浏览器和 Node.js 中使用机器学习技术了</li>
</ul>
<h3 id="Tensorflow-js-具体功能"><a href="#Tensorflow-js-具体功能" class="headerlink" title="Tensorflow.js 具体功能"></a>Tensorflow.js 具体功能</h3><ul>
<li>运行现有模型</li>
<li>重新训练现有模型</li>
<li>使用 javascript 开发机器学习模型</li>
</ul>
<h2 id="3-2-安装-Tensorflow-js"><a href="#3-2-安装-Tensorflow-js" class="headerlink" title="3-2 安装 Tensorflow.js"></a>3-2 安装 Tensorflow.js</h2><h3 id="在浏览器中安装"><a href="#在浏览器中安装" class="headerlink" title="在浏览器中安装"></a>在浏览器中安装</h3><ul>
<li>使用 script 标签<ul>
<li>使用 <code>npm i nrm -g</code>，然后 <code>nrm ls</code>，然后 <code>nrm use taobao</code>，安装 http-server <code>npm i http-server -g</code>，使用http-server 命令行输入 <code>hs</code> 即可</li>
</ul>
</li>
<li>使用 npm 包安装，并使用 parcel 或者 webpack 构建<ul>
<li><code>npm install @tensorflow/tfjs</code></li>
<li><code>npm install -g parcel-bundler</code></li>
</ul>
</li>
</ul>
<h3 id="在-Node-js-中安装"><a href="#在-Node-js-中安装" class="headerlink" title="在 Node.js 中安装"></a>在 Node.js 中安装</h3><ul>
<li>安装带有原生 C++ 绑定的 TensorFlow.js（推荐，但是麻烦）<ul>
<li>安装 node-gyp，专门用来构建底层库<ul>
<li>windows：<code>npm i node-gyp windows-build-tools@4.0.0 -g</code></li>
</ul>
</li>
<li></li>
</ul>
</li>
<li>在 GPU 上安装 TensorFlow.js</li>
<li>安装纯 Javascript 版本，这是性能方面最慢的选项</li>
</ul>
<h2 id="3-3-为何要用-Tensor？"><a href="#3-3-为何要用-Tensor？" class="headerlink" title="3-3 为何要用 Tensor？"></a>3-3 为何要用 Tensor？</h2><h3 id="什么是-Tensor？"><a href="#什么是-Tensor？" class="headerlink" title="什么是 Tensor？"></a>什么是 Tensor？</h3><ul>
<li>中文名字是 <strong><em>张量</em></strong></li>
<li>张量是向量和矩阵向更高维度的推广</li>
<li>相当于多维数组，但是有别的属性，例如形状、大小，关注rank，size，shape</li>
</ul>
<h3 id="Tensor-和机器学习有什么关系？"><a href="#Tensor-和机器学习有什么关系？" class="headerlink" title="Tensor 和机器学习有什么关系？"></a>Tensor 和机器学习有什么关系？</h3><ul>
<li><p>神经网络是什么样子</p>
</li>
<li><p>如果放你设计神经网络的数据结构，你会怎么设计？</p>
<ul>
<li>上面例子中</li>
<li>五官、身材、学历、家境，作为输入的数值</li>
<li>那形象这个神经元举例，他要存储五官、身材、学历、家境这四个输入的权重。财富、品质、有趣是一样的</li>
<li>形象、财富、品质、有趣乘以各自的权重得到满意程度，满意程度之中包含了形象、财富、品质、有趣的权重</li>
<li>按照这个例子，每一个神经元是一个四个元素的数组，每一层的神经元可以设计成一个二维数组</li>
<li>这个例子中一层要进行两次循环</li>
</ul>
<h3 id="神经网络数据结构设计"><a href="#神经网络数据结构设计" class="headerlink" title="神经网络数据结构设计"></a>神经网络数据结构设计</h3><ul>
<li>神经网络每一层要存储 N 堆数据</li>
<li>N 层的 For 循环运算</li>
<li>Tensor 作为高位数据结构完美解决以上问题</li>
</ul>
</li>
</ul>
<pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> tf <span class="token keyword">from</span> <span class="token string">'@tensorflow/tfjs'</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// 传统 for 循环</span>
<span class="token keyword">const</span> input <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> w <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> output <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> w<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> input<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    output<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span><span class="token operator">=</span> input<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> w<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">// 使用 tensor</span>
tf<span class="token punctuation">.</span><span class="token function">tensor</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">dot</span><span class="token punctuation">(</span>tf<span class="token punctuation">.</span><span class="token function">tensor</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<blockquote>
<p>数学原理，点乘，旋转</p>
</blockquote>
<h1 id="第4章-线性回归"><a href="#第4章-线性回归" class="headerlink" title="第4章 线性回归"></a>第4章 线性回归</h1><h2 id="4-1-线性回归任务简介"><a href="#4-1-线性回归任务简介" class="headerlink" title="4-1 线性回归任务简介"></a>4-1 线性回归任务简介</h2><h3 id="什么是线性回归？"><a href="#什么是线性回归？" class="headerlink" title="什么是线性回归？"></a>什么是线性回归？</h3><ul>
<li>利用数理统计中回归分析，来确定两种或两种以上变量间相互依赖的定量关系的一种统计分析方法</li>
<li>例子：身高体重数据，预测身高体重</li>
</ul>
<h3 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h3><ul>
<li>准备、可视化训练数据</li>
<li>使用 Tensorflow.js 的 API 构建神经网络</li>
<li>训练模型并预测</li>
</ul>
<h2 id="4-2-准备、可视化训练数据"><a href="#4-2-准备、可视化训练数据" class="headerlink" title="4-2 准备、可视化训练数据"></a>4-2 准备、可视化训练数据</h2><h3 id="操作步骤-1"><a href="#操作步骤-1" class="headerlink" title="操作步骤"></a>操作步骤</h3><ul>
<li>准备线性回归训练数据</li>
<li>使用 tfvis 可视化训练数据</li>
</ul>
<pre class=" language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> tfvis <span class="token keyword">from</span> <span class="token string">'@tensorflow/tfjs-vis'</span>

window<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> xs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> ys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token comment" spellcheck="true">// 散点图</span>
  tfvis<span class="token punctuation">.</span>render<span class="token punctuation">.</span><span class="token function">scatterplot</span><span class="token punctuation">(</span>
    <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'线性回归训练集'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> values<span class="token punctuation">:</span> xs
      <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          x<span class="token punctuation">,</span>
          y<span class="token punctuation">:</span> ys<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> xAxisDomain<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> yAxisDomain<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<h3 id="4-3-定义模型结构：单层单个神经元组成的神经网络"><a href="#4-3-定义模型结构：单层单个神经元组成的神经网络" class="headerlink" title="4-3 定义模型结构：单层单个神经元组成的神经网络"></a>4-3 定义模型结构：单层单个神经元组成的神经网络</h3><h3 id="操作步骤-2"><a href="#操作步骤-2" class="headerlink" title="操作步骤"></a>操作步骤</h3><ul>
<li>初始化一个神经网络模型</li>
<li>为神经网络添加层</li>
<li>设计层的神经元个数 和 输入形状（inputShape）</li>
</ul>
<pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// 连续的模型，这一层的输入是下一层的输出</span>
  <span class="token keyword">const</span> model <span class="token operator">=</span> tf<span class="token punctuation">.</span><span class="token function">sequential</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment" spellcheck="true">// 给模型添加层</span>
  <span class="token comment" spellcheck="true">// dense 全链接层</span>
  model<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>tf<span class="token punctuation">.</span>layers<span class="token punctuation">.</span><span class="token function">dense</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    units<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// 神经元个数</span>
    inputShape<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// 输入形状</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/02/temp/Rxjs%20%E5%B8%B8%E8%A7%81%E6%93%8D%E4%BD%9C%E7%AC%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/icon.jpg">
      <meta itemprop="name" content="吕嘉文">
      <meta itemprop="description" content="记录生活、工作、学习的点点滴滴">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嘉文小栈">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/02/temp/Rxjs%20%E5%B8%B8%E8%A7%81%E6%93%8D%E4%BD%9C%E7%AC%A6/" class="post-title-link" itemprop="url">Rxjs 常见操作符</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-06-02 18:37:45 / 修改时间：18:38:06" itemprop="dateCreated datePublished" datetime="2020-06-02T18:37:45+08:00">2020-06-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B8%B4%E6%97%B6/" itemprop="url" rel="index"><span itemprop="name">临时</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在思考维度上，添加时间的考量。</p>
<p>把事件想象成随着时间变化的流。</p>
<p>流主动把事件推给你，不像传统编程我们要不同去拉。</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">const</span> length$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">fromEvent</span><span class="token punctuation">(</span>length<span class="token punctuation">,</span> <span class="token string">'keyup'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pluck</span><span class="token punctuation">(</span><span class="token string">'target'</span><span class="token punctuation">,</span><span class="token string">'value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 下面的代码等同于 Rx.Observable.fromEvent(width, 'keyup').map(ev => ev.target.value);</span>
<span class="token keyword">const</span> width$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">fromEvent</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> <span class="token string">'keyup'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pluck</span><span class="token punctuation">(</span><span class="token string">'target'</span> <span class="token string">'value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//const area$ = Rx.Observable.combineLatest(length$, width$, (l, w) => {return l*w});</span>
<span class="token keyword">const</span> area$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">zip</span><span class="token punctuation">(</span>length$<span class="token punctuation">,</span> width$<span class="token punctuation">,</span> <span class="token punctuation">(</span>l<span class="token punctuation">,</span> w<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span><span class="token keyword">return</span> l<span class="token operator">*</span>w<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
area$<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>value <span class="token operator">=</span><span class="token operator">></span> area<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h2 id="常见操作符（一）"><a href="#常见操作符（一）" class="headerlink" title="常见操作符（一）"></a>常见操作符（一）</h2><h3 id="常见的创建类操作符"><a href="#常见的创建类操作符" class="headerlink" title="常见的创建类操作符"></a>常见的创建类操作符</h3><ol>
<li>from：把数组、Promise、以及 Iterable 转化为 Observable，例如 <code>Rx.Observable.from([1, 2, 3, 4])</code></li>
<li>fromEvent：把事件转化为 Observable</li>
<li>of：接受一系列的数据并把它们 emit 出去，例如 <code>Rx.Observable.of({id:1,value:20},{id:2,value:30})</code></li>
</ol>
<h3 id="常见转换类操作符"><a href="#常见转换类操作符" class="headerlink" title="常见转换类操作符"></a>常见转换类操作符</h3><ol>
<li>map：对原始流中的元素进行处理，映射成新的元素</li>
<li>mapTo：将流的值变成一个常量，例如上面的例子 <code>Rx.Observable.fromEvent(width, &#39;keyup&#39;).mapTo(1)</code>，等不关心一个点击事件的内容，只关心事件发生了的时候可以用，等同于 <code>Rx.Observable.fromEvent(width, &#39;keyup&#39;).map(_ =&gt; 1)</code></li>
<li>pluck：</li>
</ol>
<h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><p>新建一个 quote.module.ts</p>
<pre><code>export interface Quote {
  id?: string;
  cn: string;
  pic: string;
  en: string
}</code></pre><p>在根目录下建立 mock 文件夹和 data.json 文件</p>
<pre><code>{
  &quot;quotes&quot;: [
    {
      &quot;id&quot;: 1,
      &quot;cn&quot;: &#39;ads&#39;,
      &quot;en&quot;: &#39;adfs&#39;,
      &quot;pic&quot;: &#39;/abc_hello.png&#39;
    }
  ]
}</code></pre><p>敲击<code>json-server ./mock</code></p>
<p>新建 quote.service.ts，快捷方式 <code>ng-service</code></p>
<pre><code>import { Injectable, Inject } from &#39;@angular/core&#39;;
import { Http } from &#39;@angular/http&#39;
import { Observable } from &#39;rxjs/Observable&#39;;
import { Quote } from &#39;../domain/quote.model&#39;;

@Injectable()
export class QuoteService {
  constructor(
      private http: Http,
      @Inject(&#39;BASE_CONFIG) private config
  ) {}

  getQuote():Observable&lt;Quote&gt; {
      const uri = `${this.config.uri}/quote/Math.floor(${Math.random()*10)}`
    return this.http.get(uri)
        .map(res =&gt; res.json() as Quote)
  }
}</code></pre><p>修改 services 目录下的 services.module.ts 文件</p>
<pre><code>import {NgModule,ModuleWithProviders} from &#39;@angular/core&#39;;
import { CommonModule } from &#39;@angular/common&#39;;
import { QuoteService } from &#39;./quote.service&#39;;

@NgModule()
export class ServicesModule {
  static forRoot(): ModuleWithProviders {
    return {
      ngModule: ServiceModule,
      providers: [QuoteService]
    }
  }
}</code></pre><p>在 CoreModule 的 @NgModule 中添加一个 provider</p>
<pre><code>...
providers: [
  {provide: &#39;BASE_CONFIG&#39;, useValue: {
      uri: &#39;http://localhost:3000&#39;
  }}
]
...</code></pre><p>修改loginComponent，在 constructor 中添加 <code>private quoteService$:QuoteService</code>，生命一个变量 <code>quote: Quote</code>    继续修改constructor，注意，要给 quote 一个初始只，防止网络不通的时候</p>
<pre><code>this.quoteService$
    .getQuote()
    .subscribe(q =&gt; this.quote = q);</code></pre><h2 id="常见操作符（二）"><a href="#常见操作符（二）" class="headerlink" title="常见操作符（二）"></a>常见操作符（二）</h2><h3 id="Observable-的性质"><a href="#Observable-的性质" class="headerlink" title="Observable 的性质"></a>Observable 的性质</h3><ol>
<li>next：</li>
<li>error：</li>
<li>Complete：</li>
<li>特殊的 <ol>
<li>永不结束</li>
<li>Never（不结束，也不发射）</li>
<li>Empty（结束但不发射）</li>
<li>Throw（直接进入error 状态）</li>
</ol>
</li>
</ol>
<h3 id="操作符"><a href="#操作符" class="headerlink" title="操作符"></a>操作符</h3><ol>
<li>工具类操作符：do</li>
<li>变换类操作符：scan</li>
<li>数学类操作符：reduce</li>
<li>过滤类操作符： filter, take, first/last, skip</li>
<li>创建类操作符：Interval, Timer</li>
</ol>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><p>subscribe 可以接受三个<strong>函数</strong>作为参数</p>
<pre class=" language-Js"><code class="language-Js">const interval$ = Rx.Observable.interval(100).take(3);
interval$.subscribe(
    val => console.log(val),
    err => console.log(err),
    () => console.log('I am complete')
)</code></pre>
<h2 id="例子-1"><a href="#例子-1" class="headerlink" title="例子"></a>例子</h2><pre class=" language-js"><code class="language-js"><span class="token comment" spellcheck="true">// const timer$ = Rx.Observable.timer(100);</span>
<span class="token keyword">const</span> timer$ <span class="token operator">=</span> Rx<span class="token punctuation">.</span>Observable<span class="token punctuation">.</span><span class="token function">timer</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
timer$<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>val <span class="token operator">=</span><span class="token operator">></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h3 id="例子-do"><a href="#例子-do" class="headerlink" title="例子 - do"></a>例子 - do</h3><p>do 可以作为一个跟外部进行一些交互，做一些处理</p>
<pre><code>const logLabel = &#39;当前的·值改变了&#39;;
const interval$ = Rx.Observable.interval(100)
    .map(val =&gt; val * 2)
    .do(v =&gt; console.log(logLabel + v))
    .take(3);
interval$.subscribe(val =&gt; console.log(val));</code></pre><h3 id="例子-filter"><a href="#例子-filter" class="headerlink" title="例子 - filter"></a>例子 - filter</h3><p>本来应该 0，1，2 结束，现在变成0，1，2，3，4</p>
<pre><code>const logLabel = &#39;当前的·值改变了&#39;;
const interval$ = Rx.Observable.interval(100)
    .filter(val =&gt; val % 2 === 0)
    .do(v =&gt; console.log(logLabel + v))
    .take(3);
interval$.subscribe(val =&gt; console.log(val));</code></pre><h3 id="例子-first-和-last"><a href="#例子-first-和-last" class="headerlink" title="例子 - first 和 last"></a>例子 - first 和 last</h3><p>.first 和 .take(1)</p>
<p>无穷序列的last() 是永远不会结束的，认为制造出了 empty，无法发射值</p>
<pre><code>const interval$ = Rx.Observable.interval(100)
    .filter(val =&gt; val % 2 === 0)
    .first()
interval$.subscribe(
    val =&gt; console.log(val),
    err =&gt; console.log(err),
    () =&gt; console.log(&#39;completed)
)</code></pre><h3 id="例子-skip"><a href="#例子-skip" class="headerlink" title="例子 - skip"></a>例子 - skip</h3><pre><code>const interval$ = Rx.Observable.interval(100)
    .filter(val =&gt; val % 2 === 0)
    .skip(2)
interval$.subscribe(
    val =&gt; console.log(val),
    err =&gt; console.log(err),
    () =&gt; console.log(&#39;completed)
)</code></pre><h3 id="例子-scan"><a href="#例子-scan" class="headerlink" title="例子 - scan"></a>例子 - scan</h3><p>接受一个函数作为参数 ，第一个参数是累加结果，y 是序列的新值</p>
<pre><code>const interval$ = Rx.Observable.interval(100)
    .filter(val =&gt; val % 2 === 0)
    .scan((x, y) =&gt; return x + y) 
    .take(4)
interval$.subscribe(
    val =&gt; console.log(val),
    err =&gt; console.log(err),
    () =&gt; console.log(&#39;completed)
)</code></pre><h1 id="其他高阶操作符"><a href="#其他高阶操作符" class="headerlink" title="其他高阶操作符"></a>其他高阶操作符</h1><h2 id="mergeMap-和-switchMap"><a href="#mergeMap-和-switchMap" class="headerlink" title="mergeMap 和 switchMap"></a>mergeMap 和 switchMap</h2><p>删除文章的时候，后台要同时删除文章下面的评论，如果连续两个删除文章请求，服务器收到第二个请求的话，如果要继续删除第一篇文章的数据，就是mergeMap，如果不再删除第一篇的数据了，直接去删除第二篇的数据的话，就用 switchMap。 </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/02/languages/javascript%20%E5%A5%87%E6%B7%AB%E5%B7%A7%E6%8A%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/icon.jpg">
      <meta itemprop="name" content="吕嘉文">
      <meta itemprop="description" content="记录生活、工作、学习的点点滴滴">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嘉文小栈">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/02/languages/javascript%20%E5%A5%87%E6%B7%AB%E5%B7%A7%E6%8A%80/" class="post-title-link" itemprop="url">javascript 奇淫巧技</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-06-02 17:57:46 / 修改时间：18:44:08" itemprop="dateCreated datePublished" datetime="2020-06-02T17:57:46+08:00">2020-06-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" itemprop="url" rel="index"><span itemprop="name">编程语言</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>想要从 arr 得到 arr2 的两种方法</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> arr<span class="token operator">=</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token string">"内容"</span><span class="token punctuation">,</span><span class="token string">"内容2"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token string">"内容"</span><span class="token punctuation">,</span><span class="token string">"内容2"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token string">"内容"</span><span class="token punctuation">,</span><span class="token string">"内容2"</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> arr2<span class="token operator">=</span><span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> arr2 <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>cur <span class="token operator">=</span><span class="token operator">></span> cur<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
arr2 <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> item <span class="token operator">=</span><span class="token operator">></span> item<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<p>js 对象如何优雅的去一个深度的值</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    school<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      class1<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        student<span class="token punctuation">:</span> <span class="token number">50</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">// 土法</span>
<span class="token keyword">let</span> student <span class="token operator">=</span> obj<span class="token operator">?</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>school<span class="token operator">?</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>school<span class="token punctuation">.</span>class1<span class="token operator">?</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>school<span class="token punctuation">.</span>class1<span class="token punctuation">.</span>studnet<span class="token operator">?</span>obj<span class="token punctuation">.</span>school<span class="token punctuation">.</span>class1<span class="token punctuation">.</span>studnet<span class="token punctuation">:</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token string">''</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// 高级一</span>
<span class="token keyword">function</span> <span class="token function">getter</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> exec <span class="token operator">=</span> <span class="token string">'_'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token keyword">get</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>o<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> n <span class="token operator">===</span> exec <span class="token operator">?</span>
        target <span class="token punctuation">:</span>
        <span class="token function">getter</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> target <span class="token operator">===</span> <span class="token string">'undefined'</span> <span class="token operator">?</span> target <span class="token punctuation">:</span> target<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">,</span> exec<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getter</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span>school<span class="token punctuation">.</span>class1<span class="token punctuation">.</span>student<span class="token punctuation">.</span>_<span class="token punctuation">)</span><span class="token comment" spellcheck="true">//50</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getter</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span>school1<span class="token punctuation">.</span>class11<span class="token punctuation">.</span>student<span class="token punctuation">.</span>_<span class="token punctuation">)</span><span class="token comment" spellcheck="true">//undefined</span>

<span class="token comment" spellcheck="true">// 高级二</span>
<span class="token keyword">function</span> <span class="token function">safeProps</span><span class="token punctuation">(</span>func<span class="token punctuation">,</span> defaultVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> defaultVal<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">safeProps</span><span class="token punctuation">(</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    student <span class="token operator">=</span> obj<span class="token punctuation">.</span>school<span class="token punctuation">.</span>class1<span class="token punctuation">.</span>student
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre>
<p>判断类型</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">var</span> types <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Array"</span><span class="token punctuation">,</span> <span class="token string">"Boolean"</span><span class="token punctuation">,</span> <span class="token string">"Date"</span><span class="token punctuation">,</span> <span class="token string">"Number"</span><span class="token punctuation">,</span> <span class="token string">"Object"</span><span class="token punctuation">,</span> <span class="token string">"RegExp"</span><span class="token punctuation">,</span> <span class="token string">"String"</span><span class="token punctuation">,</span> <span class="token string">"Window"</span><span class="token punctuation">,</span> <span class="token string">"HTMLDocument"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">isType</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"[object "</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"[object "</span> <span class="token operator">+</span> type <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">;</span></code></pre>
<h2 id="window-onload-和-document-ready"><a href="#window-onload-和-document-ready" class="headerlink" title="window.onload 和 $(document).ready()"></a>window.onload 和 $(document).ready()</h2><table>
<thead>
<tr>
<th><code>window.onload</code></th>
<th><code>$(document).ready()</code></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>执行时间</td>
<td>必须等待网页中所有的内容加载完毕（）包括图片才执行</td>
<td>只需要 DOM 加载完就执行（不包括图片等）</td>
<td></td>
</tr>
<tr>
<td>编写个数</td>
<td>不能同时编写多个</td>
<td>能同时编写多个</td>
<td></td>
</tr>
<tr>
<td>简化写法</td>
<td>无</td>
<td>$(document).ready(function(){}) 可以简写成 $(function(){})</td>
<td></td>
</tr>
</tbody></table>
<h2 id="精确获取页面元素位置的方式有哪些"><a href="#精确获取页面元素位置的方式有哪些" class="headerlink" title="精确获取页面元素位置的方式有哪些"></a>精确获取页面元素位置的方式有哪些</h2><p>那就是使用getBoundingClientRect()方法。它返回一个对象，其中包含了left、right、top、bottom四个属性，分别对应了该元素的左上角和右下角相对于浏览器窗口（viewport）左上角的距离。</p>
<pre><code>var X= this.getBoundingClientRect().left;
var Y =this.getBoundingClientRect().top;
//再加上滚动距离，就可以得到绝对位置
var X= this.getBoundingClientRect().left + document.documentElement.scrollLeft;
var Y =this.getBoundingClientRect().top + document.documentElement.scrollTop;</code></pre>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/02/tools/sublime%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/icon.jpg">
      <meta itemprop="name" content="吕嘉文">
      <meta itemprop="description" content="记录生活、工作、学习的点点滴滴">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嘉文小栈">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/02/tools/sublime%E4%BD%BF%E7%94%A8/" class="post-title-link" itemprop="url">sublime 使用</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-06-02 17:48:30 / 修改时间：17:48:44" itemprop="dateCreated datePublished" datetime="2020-06-02T17:48:30+08:00">2020-06-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">工具</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ol>
<li>[ctrl + p]是 go to anything<br> a. [/]之后直接跟地址<br> b. [:]之后接行号<br> c. [@]之后可以接选择器或者函数</li>
<li>多行游标功能：利用光标对他们进行整体修改。也可以选择“：{”修改的内容。<br> a. 光标移动到一个单词上，按快捷键 [Ctrl + D]，会选中当前单词，再按一次选中下一个单词，可以一直重复操作。[Ctrl + K]跳过当前选择，再按[Ctrl + D]，选择下一个。<br> b. 也可以使用[Ctrl]，然后用鼠标选择。<br> c. 选中第一个之后按快捷键 [Alt+ F3] 全选内容。<br> d. 选中之后按[Ctrl + Shift + L]，进行拆行。<br> e. 选择一个位置，然后按住[Shift]键，再拖动鼠标右键。</li>
<li>Ctrl + H 能够实现替换</li>
<li>命令模式<br> a. [ctrl + shift + P]启动命令模式<br> b. set syntax javascript，切换语法模式，支持模糊匹配，js就可以表示javascript<br> c. 可以减少记忆快捷键和使用鼠标</li>
<li>综合技巧演示<br> a. ctrl + N 新建工作区<br> b. ctrl + shift + P，打开命令模式<br> c. 输入ss html，通过模糊匹配，确定语法<br> d. [edit - tag - closetag]，闭合标记，快捷键为Alt + .<br> e. 输入感叹号，快捷键[ctrl + E]，直接输出一大段html代码（需要插件）<br> f. 输入[ctrl + P]，go to anything，在页面中搜索用#开头，输入#body，按一下回车，然后光标移动到body，再按[ctrl + Enter]，在下面添加一行<br> e. 生成无序列表ul&gt;.item$*10，”.”代表class，”$”代表序号，再按ctrl + e<br> f. 选中一块代码，ctrl + ]，就是增加缩进<br> g. 鼠标选中”&lt;&gt;”标记，按住[alt + F3]全选，移动方向键，按回车，输入h2{this is a tittle}，大括号在插件中的意思是输出内容，光标移动到行末尾，按[ctrl + E]<br> h. [ctrl + shift +enter]，可以在上一行插入代码<br> i. [ctrl + shift + v]，在粘贴的同时保留了缩进</li>
<li>sublime的高级特性：<br> a. 安装package control 插件<br> b. ctrl + shift + P，搜索pci，theme进行<br> c. snippets 以模板的方式进行<br> d. 使用插件 Javascript &amp; NodeJS Snippets,输入gi就会出现document.getElementById(‘id’);用好tab键；更多功能上<a href="https://packagecontrol.io/上面输入插件名称，在里边找" target="_blank" rel="noopener">https://packagecontrol.io/上面输入插件名称，在里边找</a><br> e. 安装JQuery<br> f. PersonModule.findOne({name:’test’},function(err,result){<pre><code> console.log(result);</code></pre> });安装插件Insert Callback 之后，可以用快捷键[alt +c]实现这个功能。<br> g. advanceNewfile插件，用[ctrl + alt + N]，可以建了之后直接输入名称，或者用……/……直接在指定目录下创建<br> h. 测试get和post请求，用httpRequest,快捷键[Ctrl +alt + R]<br> i. nettus fetch，写前端程序，下载类库和更新类库，命令模式，fetch manage管理，可以下载和管理underscore<br> j. sidebarenhancement 增强sidebar<br> k. 快速添加注释，docblocker，/<em>或者/*</em>之后按回车，在函数的上方输入/**，之后按住tab键就会自动生成注释<br> l. 使用lint进行语法及风格校验，先安装sublimeLinter，之后NodeJS，然后<code>cnpm install jshint</code>,配置 jshint, 在项目文件夹下创建 .jshintrc 文件，配置三个等号在文件中写如下内容，在 jshint.com 中有所有可配置信息的所有说明<pre><code>{
 &quot;eqeqeq&quot;: true;
}</code></pre></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/02/temp/%E5%AD%A6%E4%B9%A0%20stylus/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/icon.jpg">
      <meta itemprop="name" content="吕嘉文">
      <meta itemprop="description" content="记录生活、工作、学习的点点滴滴">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嘉文小栈">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/02/temp/%E5%AD%A6%E4%B9%A0%20stylus/" class="post-title-link" itemprop="url">学习 stylus</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-06-02 17:47:05 / 修改时间：17:48:20" itemprop="dateCreated datePublished" datetime="2020-06-02T17:47:05+08:00">2020-06-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B8%B4%E6%97%B6/" itemprop="url" rel="index"><span itemprop="name">临时</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="package-json-中使用-stylus"><a href="#package-json-中使用-stylus" class="headerlink" title="package.json 中使用 stylus"></a>package.json 中使用 stylus</h4><pre class=" language-css"><code class="language-css"><span class="token selector">scripts: </span><span class="token punctuation">{</span>
  <span class="token string">'stylus'</span><span class="token punctuation">:</span> <span class="token string">'mkdir css &amp; stylus -m -w styl/ -o css/'</span>
<span class="token punctuation">}</span>
</code></pre>
<h4 id="gulp-中使用-stylus"><a href="#gulp-中使用-stylus" class="headerlink" title="gulp 中使用 stylus"></a>gulp 中使用 stylus</h4><pre class=" language-bash"><code class="language-bash"><span class="token function">npm</span> i gulp-stylus gulp-clean-css -D</code></pre>
<p>gulpfile.js</p>
<pre class=" language-javascript"><code class="language-javascript">gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'stylus'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'./styl/..'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">stylus</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      compress<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token string">'include css'</span><span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">cleanCSS</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      level<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      rebaseTo<span class="token punctuation">:</span> <span class="token string">'css/'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span>DEST <span class="token operator">+</span> 'css<span class="token operator">/</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h4 id="N-M-选择器"><a href="#N-M-选择器" class="headerlink" title="^[N..M] 选择器"></a>^[N..M] 选择器</h4><pre class=" language-css"><code class="language-css">a
  b
    c
      d 
        font-size <span class="token number">14</span>px
        <span class="token number">.</span>abc ^[-<span class="token number">1..</span>-<span class="token number">1</span>]<span class="token punctuation">:</span>hover
          color red</code></pre>
<h4 id="引用属性值"><a href="#引用属性值" class="headerlink" title="引用属性值"></a>引用属性值</h4><pre class=" language-css"><code class="language-css">p
  margin <span class="token number">10</span>px
  padding <span class="token punctuation">(</span>@margin / <span class="token number">2</span><span class="token punctuation">)</span></code></pre>
<p>场景： 已知宽高绝对居中</p>
<pre class=" language-css"><code class="language-css">#logo
position absolute
top <span class="token number">50%</span>
left <span class="token number">50%</span>
width <span class="token number">150</span>px
height <span class="token number">80</span>px
margin-left <span class="token function">-</span><span class="token punctuation">(</span>@width / <span class="token number">2</span><span class="token punctuation">)</span>
margin-top <span class="token function">-</span><span class="token punctuation">(</span>@height / <span class="token number">2</span><span class="token punctuation">)</span></code></pre>
<h4 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h4><p>属性名里边用 n 要带上{}，属性值里边直接用</p>
<pre class=" language-css"><code class="language-css"><span class="token selector">for n in 1<span class="token class">..10</span>
  <span class="token class">.col-</span></span><span class="token punctuation">{</span>n<span class="token punctuation">}</span>
    width <span class="token number">10%</span> * n</code></pre>
<p>使用场景：日历组件</p>
<pre class=" language-css"><code class="language-css"><span class="token selector">for n in (0<span class="token class">..6</span>)
  saturday = 8 - n
  sunday = 9 - n
  &amp;<span class="token class">.empty-</span></span><span class="token punctuation">{</span>n<span class="token punctuation">}</span>
    <span class="token selector">flex n n 14<span class="token class">.285714</span>% * n
    min-width 14<span class="token class">.285714</span>% * n
    max-width 100%

    ~<span class="token pseudo-class">:nth-child</span>(7n + </span><span class="token punctuation">{</span>saturday<span class="token punctuation">}</span><span class="token selector">),
    ~<span class="token pseudo-class">:nth-child</span>(7n + </span><span class="token punctuation">{</span>sunday<span class="token punctuation">}</span><span class="token punctuation">)</span>
      color orange</code></pre>
<p>使用场景：spin 页面加载</p>
<pre class=" language-css"><code class="language-css"><span class="token selector"><span class="token class">.bar</span>
  animation suofang 1s ease-in-out infinite
  for n in 1<span class="token class">..5</span>
    &amp;<span class="token pseudo-class">:nth-child</span>(</span><span class="token punctuation">{</span>n<span class="token punctuation">}</span><span class="token punctuation">)</span>
      animation-delay <span class="token number">.1</span>s * n

@keyframe suofang
  <span class="token number">0%</span>
    transform <span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">.2</span><span class="token punctuation">)</span>
  <span class="token number">50%</span>
    transform <span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token number">100%</span>
    transform <span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">.2</span><span class="token punctuation">)</span></code></pre>
<h4 id="条件判断"><a href="#条件判断" class="headerlink" title="条件判断"></a>条件判断</h4><pre class=" language-css"><code class="language-css">$need-support-ie = true
body
  if $need-support-ie 
    padding <span class="token number">5</span>px
  else
    margin <span class="token number">5</span>px</code></pre>
<h4 id="mixin-amp-functions"><a href="#mixin-amp-functions" class="headerlink" title="mixin &amp; functions"></a>mixin &amp; functions</h4><pre class=" language-css"><code class="language-css"><span class="token function">border-radius</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
  -webkit-border-radius n
  -moz-border-radius n
  border-radius n

form input[type=button]
  <span class="token function">border-radius</span><span class="token punctuation">(</span><span class="token number">5</span>px<span class="token punctuation">)</span> // function
  border-radius <span class="token number">5</span>px // mixin</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/02/languages/javascript%E4%BD%9C%E7%94%A8%E5%9F%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/icon.jpg">
      <meta itemprop="name" content="吕嘉文">
      <meta itemprop="description" content="记录生活、工作、学习的点点滴滴">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嘉文小栈">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/02/languages/javascript%E4%BD%9C%E7%94%A8%E5%9F%9F/" class="post-title-link" itemprop="url">javascript 作用域</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-06-02 17:44:53 / 修改时间：17:45:22" itemprop="dateCreated datePublished" datetime="2020-06-02T17:44:53+08:00">2020-06-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" itemprop="url" rel="index"><span itemprop="name">编程语言</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="javascript-函数的执行"><a href="#javascript-函数的执行" class="headerlink" title="javascript 函数的执行"></a>javascript 函数的执行</h1><p>闭包相关知识图谱</p>
<ul>
<li>闭包<ul>
<li>表达式部分：lamada 表达式</li>
<li>环境部分<ul>
<li>环境<ul>
<li>变量环境</li>
<li>词法环境</li>
<li>this值</li>
</ul>
</li>
<li>标识符列表：函数中用到的未声明的变量</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>javascript 函数相关知识图谱：</p>
<ul>
<li>javascript 函数<ul>
<li>表达式部分：函数</li>
<li>环境部分：函数的词法环境部分组成<ul>
<li>函数里面不带 var 、let、const 的变量</li>
<li>词法作用域（执行上下文的一部分）<ul>
<li>scope</li>
<li>this值</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>从图上可以看出，二者是可以对应起来的。</p>
<h2 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h2><p>在上世纪60年代，主流编程语言是基于 lamada 演算的函数式编程语言。</p>
<p>对闭包，一个不太精确的描述是，<strong>带有一系列信息的 lamada 表达式</strong>（在函数式语言中，lamada表达式就是函数）。</p>
<p>进一步理解，<strong>闭包是一个绑定了执行环境的函数</strong></p>
<p>闭包不同于普通函数之处在于，他<strong>携带了执行的环境</strong>。</p>
<blockquote>
<p>误区：执行上下文或者作用域（scope，ES3中规定的执行上下文的一部分）就是闭包（这是错的）</p>
</blockquote>
<p><strong>javascript 中闭包对应的概念就是函数。</strong></p>
<h2 id="执行上下文：执行的基础设施"><a href="#执行上下文：执行的基础设施" class="headerlink" title="执行上下文：执行的基础设施"></a>执行上下文：执行的基础设施</h2><p>JavaScript 标准把一段代码（包括函数），执行所需的所有信息定义为：“<strong>执行上下文</strong>”。</p>
<h3 id="执行上下文的演变"><a href="#执行上下文的演变" class="headerlink" title="执行上下文的演变"></a>执行上下文的演变</h3><h4 id="ES3中的执行上下文"><a href="#ES3中的执行上下文" class="headerlink" title="ES3中的执行上下文"></a>ES3中的执行上下文</h4><ul>
<li>scope：作用域，也叫作用域链</li>
<li>variable object： 变量对象，用于存储变量的对象</li>
<li>this value： this 值</li>
</ul>
<h4 id="ES5-中的执行上下文"><a href="#ES5-中的执行上下文" class="headerlink" title="ES5 中的执行上下文"></a>ES5 中的执行上下文</h4><ul>
<li>lexical enrironment：词法环境，当获取变量时使用。</li>
<li>variable environment：变量环境，当声明变量时使用。</li>
<li>this value：this 值</li>
</ul>
<h4 id="ES-2018中的执行上下文"><a href="#ES-2018中的执行上下文" class="headerlink" title="ES 2018中的执行上下文"></a>ES 2018中的执行上下文</h4><ul>
<li>lexical enrironment：词法环境，当获取变量时使用或者 this 值时使用。</li>
<li>variable environment：变量环境，当声明变量时使用。</li>
<li>code evaluation state：用于恢复代码执行位置。</li>
<li>Function：执行的任务是函数时使用，表示正在执行的函数</li>
<li>ScriptOrModule：执行的任务是脚本或模块时使用，表示正在执行的代码</li>
<li>Realm：使用的基础库和内置对象实例。</li>
<li>Generator：仅生成器上下文有这个属性，表示当前生成器</li>
</ul>
<p>this 被归入了 lexical environment</p>
<h3 id="var-声明和赋值"><a href="#var-声明和赋值" class="headerlink" title="var 声明和赋值"></a>var 声明和赋值</h3><p>var 会穿透 for、if 等语句。</p>
<p>因此也就有了立即执行函数IIFE，创建一个立即执行的函数来构造一个新的作用域，控制 var 的范围。</p>
<h3 id="let"><a href="#let" class="headerlink" title="let"></a>let</h3><p>以下语句会产生 let 使用的作用域</p>
<ul>
<li>for</li>
<li>if</li>
<li>switch</li>
<li>try / catch / finally</li>
</ul>
<h3 id="Realm"><a href="#Realm" class="headerlink" title="Realm"></a>Realm</h3><p>领域、范围</p>
<h1 id="函数的种类"><a href="#函数的种类" class="headerlink" title="函数的种类"></a>函数的种类</h1><p>一旦上下文被切换，整个语句的效果可能都会发生改变。那么，切换上下文的时机就显得非常重要了。</p>
<p>在 JavaScript，切换上下文最主要的场景是函数调用。在这一课，我们就来讲讲函数调用切换上下文的事情。我们在讲函数调用之前，首先来认识一下函数家族。</p>
<h2 id="函数的分类"><a href="#函数的分类" class="headerlink" title="函数的分类"></a>函数的分类</h2><h3 id="普通函数"><a href="#普通函数" class="headerlink" title="普通函数"></a>普通函数</h3><p>用 function 关键字定义的函数</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// code</span>
<span class="token punctuation">}</span></code></pre>
<h3 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h3><p>用 =&gt; 运算符定义的函数</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// code</span>
<span class="token punctuation">}</span></code></pre>
<h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><p>在 class 中定义的函数</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token punctuation">{</span>
    <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// code</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h3 id="生成器函数"><a href="#生成器函数" class="headerlink" title="生成器函数"></a>生成器函数</h3><p>用 function* 定义的函数</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// code</span>
<span class="token punctuation">}</span></code></pre>
<h3 id="类"><a href="#类" class="headerlink" title="类"></a>类</h3><p>用 class 定义的类，实际上也是函数</p>
<pre class=" language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// code</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h3 id="异步函数"><a href="#异步函数" class="headerlink" title="异步函数"></a>异步函数</h3><p>普通函数、箭头函数、和生成器函数加上 async 关键字</p>
<pre><code>async function foo() {
    // code
}

const foo = async () =&gt; {
    // code
}
async function foo*() {
    // code
}</code></pre><h2 id="this-关键字的行为"><a href="#this-关键字的行为" class="headerlink" title="this 关键字的行为"></a>this 关键字的行为</h2><p>对普通变量而言，这些函数并没有本质区别，都是遵循了“继承定义时环境”的规则，它们的一个行为差异在于 this 关键字。</p>
<p>this 是执行上下文中很重要的一个组成部分。同一个函数调用方式不同，得到的 this 值也不同。</p>
<h4 id="普通函数的-this"><a href="#普通函数的-this" class="headerlink" title="普通函数的 this"></a>普通函数的 this</h4><pre class=" language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
    showThis<span class="token punctuation">:</span> showThis
<span class="token punctuation">}</span>

<span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">// global</span>
o<span class="token punctuation">.</span><span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">// o</span></code></pre>
<p>普通函数的 this 值由“调用它所使用的引用”决定，其中奥秘就在于：我们获取函数的表达式，它实际上返回的并非函数本身，而是一个 Reference 类型（记得我们在类型一章讲过七种标准类型吗，正是其中之一）。</p>
<p>Reference 类型由两部分组成：一个对象和一个属性值。不难理解 o.showThis 产生的 Reference 类型，即由对象 o 和属性“showThis”构成。</p>
<p>当做一些算术运算（或者其他运算时），Reference 类型会被解引用，即获取真正的值（被引用的内容）来参与运算，而类似函数调用、delete 等操作，都需要用到 Reference 类型中的对象。</p>
<p>在这个例子中，Reference 类型中的对象被当作 this 值，传入了执行函数时的上下文当中。</p>
<p>至此，我们对 this 的解释已经非常清晰了：调用函数时使用的引用，决定了函数执行时刻的 this 值</p>
<h4 id="箭头函数的-this"><a href="#箭头函数的-this" class="headerlink" title="箭头函数的 this"></a>箭头函数的 this</h4><pre><code>const showThis = () =&gt; {
    console.log(this)
}

var o = {
    showThis: showThis
}

showThis()    // global
o.showThis()    // global</code></pre><p>我们看到，改为箭头函数后，不论用什么引用来调用它，都不影响它的 this 值。</p>
<h4 id="方法的-this"><a href="#方法的-this" class="headerlink" title="方法的 this"></a>方法的 this</h4><pre><code>class C {
    showThis() {
        console.log(this)
    }
}

var o = new C()
var showThis = o.showThis()

showThis() // undefined
o.showThis() // o</code></pre><h3 id="其他函数"><a href="#其他函数" class="headerlink" title="其他函数"></a>其他函数</h3><ul>
<li>生成器函数、异步生成器函数和异步普通函数跟普通函数行为是一致的</li>
<li>异步箭头函数与箭头函数行为是一致的</li>
</ul>
<h3 id="this-关键字的机制"><a href="#this-关键字的机制" class="headerlink" title="this 关键字的机制"></a>this 关键字的机制</h3><p>在 JavaScript 标准中，为函数规定了用来保存定义时上下文的私有属性[[Environment]]。</p>
<p>当一个函数执行时，会创建一条新的执行环境记录，记录的外层词法环境（outer lexical environment）会被设置成函数的[[Environment]]。</p>
<p>这个动作就是切换上下文了。</p>
<p>JavaScript 用一个栈来管理执行上下文，这个栈中的每一项又包含一个链表。</p>
<p>当函数调用时，会入栈一个新的执行上下文，函数调用结束时，执行上下文被出栈。</p>
<p>而 this 则是一个更为复杂的机制，JavaScript 标准定义了 [[thisMode]] 私有属性。</p>
<p>[[thisMode]] 私有属性有三个取值：</p>
<ul>
<li>lexical：表示从上下文中找 this，这对应了箭头函数。</li>
<li>global：表示当 this 为 undefined 时，取全局对象，对应了普通函数。</li>
<li>strict：当严格模式时使用，this 严格按照调用时传入的值，可能为 null 或者 undefined。</li>
</ul>
<p>非常有意思的是，方法的行为跟普通函数有差异，恰恰是因为 class 设计成了默认按 strict 模式执行。</p>
<p>我们可以用 strict 达成与上一节中方法的例子一样的效果:</p>
<pre class=" language-js"><code class="language-js"><span class="token string">"use strict"</span>
<span class="token keyword">function</span> <span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
    showThis<span class="token punctuation">:</span> showThis
<span class="token punctuation">}</span>

<span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// undefined</span>
o<span class="token punctuation">.</span><span class="token function">showThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// o</span></code></pre>
<p>函数创建新的执行上下文中的词法环境记录时，会根据[[thisMode]]来标记新纪录的[[ThisBindingStatus]]私有属性。</p>
<p>代码执行遇到 this 时，会逐层检查当前词法环境记录中的[[ThisBindingStatus]]，当找到有 this 的环境记录时获取 this 的值。</p>
<p>这样的规则的实际效果是，嵌套的箭头函数中的代码都指向外层 this，例如：</p>
<pre><code>var o = {a: 1, b: 2, c: 3}
o.foo = function() {
    console.log(this)
    return () =&gt; {
        console.log(this)
        return () =&gt; console.log(this)
    }
}
o.foo()()();//o, o, o</code></pre><h3 id="操作-this-的内置函数"><a href="#操作-this-的内置函数" class="headerlink" title="操作 this 的内置函数"></a>操作 this 的内置函数</h3><pre><code>function foo(a, b, c) {
    console.log(this)
    console.log(a, b, c)
}

foo.call({d:4}, 1, 2, 3)
foo.apply({e: 5}, [1, 2, 3])</code></pre><h1 id="javascript-作用域"><a href="#javascript-作用域" class="headerlink" title="javascript 作用域"></a>javascript 作用域</h1><h1 id="javascript-闭包"><a href="#javascript-闭包" class="headerlink" title="javascript 闭包"></a>javascript 闭包</h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/02/temp/%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E4%B8%8E%E5%BC%95%E7%94%A8%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/icon.jpg">
      <meta itemprop="name" content="吕嘉文">
      <meta itemprop="description" content="记录生活、工作、学习的点点滴滴">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嘉文小栈">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/02/temp/%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E4%B8%8E%E5%BC%95%E7%94%A8%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" class="post-title-link" itemprop="url">temp/基础数据类型与引用数据类型</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-06-02 17:14:39 / 修改时间：17:15:41" itemprop="dateCreated datePublished" datetime="2020-06-02T17:14:39+08:00">2020-06-02</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="基础数据类型与引用数据类型"><a href="#基础数据类型与引用数据类型" class="headerlink" title="基础数据类型与引用数据类型"></a>基础数据类型与引用数据类型</h1><hr>
<p>title: 基础数据类型与引用数据类型<br>date:<br>categories:</p>
<ul>
<li>临时<br>tags:</li>
<li>临时</li>
</ul>
<hr>
<blockquote>
<p>数据类型：存储的时候分配多少内存，读取的时候怎么处理二进制数据</p>
</blockquote>
<h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><p>在人的角度看</p>
<p>固定的是名字，变化的是名字对应的值</p>
<p>在计算机的角度看</p>
<p>固定的是地址，变化的地址里边存储的数据</p>
<p>内存可以看做一本很厚很厚的书，每一页有一个编号（相当于地址），可以通过编号查看书写折页纸上的内容</p>
<h2 id="认识数组"><a href="#认识数组" class="headerlink" title="认识数组"></a>认识数组</h2><h3 id="数组的名与实"><a href="#数组的名与实" class="headerlink" title="数组的名与实"></a>数组的名与实</h3><ul>
<li>数组的“实”是一块地址连续的内存，像一个本子里连续的10几页</li>
<li>数组的名指向这个连续内存的第一个内存地址</li>
<li>数组的变量与基本变量一样，本身存储一个地址。但是与基本变量不一样的是，数组变量名指向的地址是数组的第一个地址</li>
<li>数组变量保存的并不是数组，而是数组的地址的第一个</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="吕嘉文"
      src="/images/icon.jpg">
  <p class="site-author-name" itemprop="name">吕嘉文</p>
  <div class="site-description" itemprop="description">记录生活、工作、学习的点点滴滴</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">106</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">33</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-at"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">吕嘉文</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
